<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

</head>
<style>
    :root {
        --label-font-size:1em;
        --key-width: calc(var(--label-font-size)*4);
        --key-height: calc(var(--label-font-size)*4);
        --key-width-scale: 1;
        --key-height-scale: 1;
    }

    div.row {
        display: flex;
    }



    div.key,
    div.placeholder {
        width: calc(var(--key-width)*var(--key-width-scale));
        height: calc(var(--key-height)*var(--key-height-scale));
        margin: 0px;

    }

    div.key>.label-wrapper:hover {
        border: rgb(223, 246, 253);
        /* background-color: rgb(223, 246, 253); */
        border-style: solid;
        box-shadow: 3px 2px 5px rgb(81 187 188);
        
        /* color: lightsalmon; */
        /* font-weight: bolder; */
        cursor: pointer;
    }
    div.key>.label-wrapper:active {
        background-color: rgb(223, 246, 253);
        box-shadow: none;

        /* color: lightsalmon; */
        font-weight: bolder;
        cursor: pointer;
    }

    div.key>.label-wrapper {
        font-size: var(--label-font-size);
        font-family: Helvetica;
        
        border-radius: 6px;
        border: #9e9e9e;
        border-style: solid;
        background-color: #fff;
          
        /* 高度撑满容器 */
        height: -webkit-fill-available;
        height: -moz-available;
        height: fill-available;
        box-shadow: 3px 2px 5px #9e9e9e;
        padding: 0.5em;
        margin: 2px;
    }
</style>

<body>
    <div class="app" x-data="appdata()">
        <template x-for="row in rows">
            <div class="row">
                <template x-for="col in row">
                    <div :class="col.class_" :style="col.style">
                        <div class="label-wrapper">
                            <!-- <div></div> -->
                            <div class="label" x-text="col.label">F1</div>
                            <div class="counter"></div>
                        </div>
                    </div>
                </template>
            </div>


        </template>
    </div>
</body>
<script src="./layout.js"></script>
<script>
    function Key( label, width=1,height=1, color='', class_= 'key',hwid=0) {
        return {hwid,label, width,height, color, class_, style: `--key-width-scale:${width}` }
    }


    const [config, ...rows] = layout;
    let formated_rows = []
    console.log(config)
    console.log(rows)
    let width = 1;
    let height=1;
    let color = '#fff';
    let id=1;
    for (const row of rows) {
        let formated_row = []
        for (const col of row) {
            if (Object.prototype.toString.call(col) === "[object String]") {
                let label = col;
                formated_row.push(Key(label, width,height,color )  )
                width = 1;
                // color = '#000'

            } else {
                if (col['w']) {
                    width = col['w']
                }
                if (col['c']) {
                    color = col['c']
                }
                if (col['x']) {
                    formated_row.push(Key('', col['x'],1,'', class_= 'placeholder' ))
                }

            }
        }
        formated_rows.push(formated_row)
        console.log(formated_row)
    }

    function appdata() {
        return {
            rows: formated_rows,
            init() { }
        };
    }
    // Alpine.start();


</script>

</html>